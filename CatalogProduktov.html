<!DOCTYPE html><html lang=sk><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed" href=/feed.rss><link rel=alternate type=application/atom+xml title="Atom Feed" href=/feed.atom><meta name=author content=harrison314><title>Katalóg produktov v relačnej databáze</title><link href=css/bootstrap.min.css rel=stylesheet><link href=css/blog-post.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><style>img{max-width:100%}.img-center{display:block;margin-left:auto;margin-right:auto}</style><body><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=index.html>harrison314 blog</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/All.html>Obsah</a><li><a href=/DevelopingAll.html>Programovanie</a><li><a href=/GeneralAll.html>Všeobecné</a><li><a href=/OMne.html>O mne</a></ul></div></div></nav><div class=container><div class=row><div class="col-lg-8 col-md-8"><h1 id=katalog-produktov-v-relacnej-databaze>Katalóg produktov v&nbsp;relačnej databáze</h1><p>Tvorba katalógov produktov a&nbsp;služieb je veľmi časté, či&nbsp;už na&nbsp;webe alebo&nbsp;v podnikovej sfére. Požiadavkou na&nbsp;takýto systém je aby&nbsp;umožňoval ukladať tovar s&nbsp;rôznymi atribútmi ako rozmery, cena, pri&nbsp;niektorých typoch produktov farba, pri&nbsp;iných výkon. Predstavte si e-shop s&nbsp;elektronikou, pri&nbsp;reproduktoroch je uvedený výkon, rozmery, dostupná farba, no&nbsp;pri stolných počítačoch je tam procesor, veľkosť pamäte, zas pri&nbsp;monitore uhlopriečka…<p>V tomto článku chcem v&nbsp;krátkosti predstaviť možné riešenia.<h2 id=naivne-riesenie>Naivné riešenie</h2><p>Pre každý typ tovaru sa vytvorí osobitná tabuľka. Zvrátenosť tohto riešenia sa ukáže pri&nbsp;18-tich druhoch tovaru a&nbsp;vo väzbách na&nbsp;18 ďalších tabuliek (žiaľ reálna skúsenosť). Toto riešenie je absolútne nevhodné z&nbsp;hľadiska normalizácie a&nbsp;neschopnosti meniť typy produktov počas „behu“.<h2 id=pouzitie-orm>Použitie ORM</h2><p>Bavíme sa o&nbsp;použití ORM podporujúceho dedenie a&nbsp;polymorfizmus entít (napr. <em>Entity Framework</em> alebo&nbsp;<em>Hibernate</em> ), žiadne trápne <em>active record</em>. Tovar je reprezentovaný ako abstraktná entita, samotné druhy tovaru sú vytvorené dedením. Toto riešenie je pekné v&nbsp;tom, že&nbsp;ORM a&nbsp;polymorfizmus spraví za&nbsp;nás všetku špinavú prácu, no&nbsp;stále nie je možné po&nbsp;nasadení aplikácie meniť typ tovaru.<h2 id=pouzitie-nosql-databazy>Použitie NoSQL databázy</h2><p>Bezschémové databázy (napr. <em>MongoDB</em>, <a href="http://docs.mongodb.org/ecosystem/use-cases/product-catalog/">katalóg v&nbsp;MongoDB</a> ) umožňujú vkladať a&nbsp;vyťahovať tovar do&nbsp;a z&nbsp;databázy s&nbsp;rôznymi atribútmi. Dokonca je možné danú schému meniť po&nbsp;nasadení aplikácie, pridávať nové druhy tovaru. Toto je jeden z&nbsp;argumentov priaznivcov NoSQL databáz. Jednoducho navrhnete „schému“ tak ako vyzerajú najčastejšie „dopyty“. Praktickej ukážke sa môžem povenovať niekedy nabudúce, no&nbsp;v tomto článku chcem ukázať ako daný problém riešiť pomocou relačnej databázy.<h2 id=riesenie-z-mudrej-knihy-eav>Riešenie z&nbsp;múdrej knihy (EAV)</h2><p>Návrhové vzory sú všeobecné riešenia problémov v&nbsp;danom kontexte. Niečo podobné jestvuje aj&nbsp;pre návrh databázových schém a&nbsp;volá sa to analytické vzory. V&nbsp;múdrej knihe (1) som narazil na&nbsp;vzor <em>Predmet zmluvy</em>, ktorý&nbsp;spĺňa všetko to čo&nbsp;potrebujeme a&nbsp;vzory pre&nbsp;cenníky produktov.<p>Výsledok je takáto databázová schéma:<p><img src=images/CatalogProduktov/Eav.png class=img-center alt="katalog v1.jpg"><p>Ide naozaj o&nbsp;abstraktný návrh, ktorý&nbsp;treba trochu ohnúť pre&nbsp;každé konkrétne použitie.<p><em>Katalog</em> – táto entita predstavuje konkrétny katalóg, pravdepodobne bude mať svoje meno ( <strong>„Katalóg jeseň-zima 2013“</strong> ) a&nbsp;svoju časovú pôsobnosť. S&nbsp;produktom má reláciu N ku N, pretože&nbsp;predpokladám, že&nbsp;ten istý produkt sa môže vyskytovať v&nbsp;rôznych katalógoch.<p><em>Produkt</em> – obsahuje len meno produktu. Je otázne, či&nbsp;má obsahovať aj&nbsp;atribúty, ktoré sú pre&nbsp;všetky produkty spoločné (napríklad cena).<p><em>TypProduktu</em> – reprezentuje typy produktov. Produktu určuje typ a&nbsp;tým aj&nbsp;to aké má vlastnosti. (Typ môže byť: PC, televízor, mixér,….).<p><em>TypVlastnostiProduktu</em> – entita určuje typ vlastnosti produktu, môže ísť o&nbsp;cenu, farbu tovaru, hmotnosť… Má reláciu k <em>TypProduktu</em> typu N ku N, pretože&nbsp;rôzny typy produktov môžu byť opísané rovnakými vlastnosťami. Pravdepodobne každý typ produktu bude mať cenu, pri&nbsp;chladničkách a&nbsp;televízoroch to môže byť hmotnosť.<p><em>TypHodnoty</em> – reprezentuje akého typu je vlastnosť produktu. Napríklad ak ide o&nbsp;hmotnosť televízora, tak typ je číselný atribút, a&nbsp;uvádza sa v&nbsp;kilogramoch. Spolu s&nbsp;týmito informáciami je možné do&nbsp;tejto entity ukladať aj&nbsp;ohraničenia pre&nbsp;hodnoty vlastností produktov ako napr. číselný rozsah. Za&nbsp;istých okolností je vhodnejšie entitu <em>TypHodnoty</em> a&nbsp;<em>TypVlastnosťiPruktu</em> zlúčiť, no&nbsp;to záleží už od&nbsp;konkrétneho návrhu.<p>Entity <em>TypProduktu</em>, <em>TypVlastnostiProduktu</em> a&nbsp;<em>TypHodnoty</em>, tvoria metaúroveň produktov. Pomocou nej je možné automaticky generovať formuláre pre&nbsp;zadávanie nových produktov. Typ produktu je možné považovať súčasne aj&nbsp;za kategóriu produktu a&nbsp;vytvoriť z&nbsp;neho menu, alebo&nbsp;pridaním rekurzívnej relácie stromovú štruktúru typov/kategórií produktov.<p><em>VlastnostProduktu</em> – táto entita obsahuje už hodnoty vlastností produktu.<p><strong>Poznámka:</strong> V&nbsp;praxi sa používa aj&nbsp;riešenie, obsahujúce tabuľky profilov produktov a&nbsp;jednu veľkú tabuľku hodnôt, ktorá pre&nbsp;každý dátový typ (int, double, krátky text, dlhý text) <em>N</em> (napr. 10) stĺpcov. V&nbsp;profile typu sa uchováva ktoré stĺpce reprezentujú akú položku produktu. Bližšie o&nbsp;tomto spôsobe dopíšem neskôr.<h2 id=zaver>Záver</h2><p>Posledné uvedené riešenie umožňuje do&nbsp;relačnej databázy uložiť takmer čokoľvek, čo&nbsp;sa aspoň trochu podobá na&nbsp;zadanie v&nbsp;úvode. No&nbsp;je potrebné viac premyslieť selkty, tiež odporúčam nejaké to cachovanie.<h2 id=zdroje>Zdroje</h2><ol><li>Šešera Ľubor RNDr. PhD., Aplikačné architektúry softvérových systémov, ISBN 978-227-3652-7<li><a href="http://docs.mongodb.org/ecosystem/use-cases/product-catalog/">http://docs.mongodb.org/ecosystem/use-cases/product-catalog/</a></ol></div><div class="col-lg-4 col-md-4 hidden-xs hidden-sm"><div class=well><h4>Vývoj</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/SkEidSign.html>Podpisovanie PDF v .Net Core</a><li><a href=/Ansible.html>Ansible a .Net Core</a><li><a href=/GoLang.html>Golang</a><li><a href=/LevenstainOptimalization.html>Optimalizácia výpočtu Levenstainovej vzdialenosti</a><li><a href=/ZabezpecnieAspMvc.html>Zabezpečenie ASP.NET MVC</a><li><a href=/UzitocneProgramy.html>Užitočné programy</a><li><a href=/CoreStreaming.html>Video straming v ASP.NET Core</a><li><a href=/Tfs15AsmVersion.html>TFS 2015 a číslo verzie assembly</a><li><a href=/ServiceLocator.html>Stupne zla Service lokátoru</a><li><a href=/Monads.html>Monády</a></ul></div></div></div><div class=well><h4>Všeobecné</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/EzoGenerator.html>Generátor Ezo textov</a><li><a href=/AlternativnyRecept.html>Propagácia alternatívnej medicíny</a><li><a href=/VotrelciDavnoveku.html>Votrelci dávnoveku</a></ul></div></div></div><div class=well><h4>O mne</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/OMne.html>O mne</a><li><a href=/OMneOdkazy.html>Moja tvorba inde</a><li><a href=/Portfolio.html>Portfólio</a></ul></div></div></div></div></div><hr><footer><div class=row><div class=col-lg-12><p>Copyright © harrison314 2013</div></div></footer></div><script src=js/jquery.js></script><script src=js/bootstrap.min.js></script>