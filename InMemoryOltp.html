<!DOCTYPE html><html lang=sk><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=X-Xss-Protection content="1; mode=block"><meta http-equiv=X-Content-Type-Options content=nosniff><meta name=viewport content="width=device-width, initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed" href=feed.rss><meta name=author content=harrison314><meta name=generator content=AspNetStatic><!--Blazor:{"type":"server","prerenderId":"8a0f6a30979747bd8584bf404bc19a37","key":{"locationHash":"77D12F14A8105320B1AAED6AE7E689DA0EC4483270A645E84079EAA0FFDF550D:5","formattedComponentKey":""},"sequence":0,"descriptor":"CfDJ8G7p01mvTipOj9seX7mukmukIaaGXzdKRz/rx1vUzngHKyipjkJ8QpsipNXV88uruLT918S/3dClsJv5pL1T0kd\u002BWXpn6u5H5JzrvRLX7s5pC5vUCrF7OZn/2CM5i0xh70\u002BvF8xmOIED6FpZLejDST6vaHMCoRlhtBw4dhQUtfi2io3wZw4BaGdLSU9Sx7KdMr1Kx9EMtDvC1lRsKNjN/PRMjX\u002ByniTq8FiqWON/suGclWqNHmGUrsxtGf2e2pSH6se2ukTZk3JGu0c9DE3kDtficD9tItskpU/D\u002BgoQs9bES97/GYPN16CHLN/bIqTw65p0GkQxEY7hwgtIDEnLzEnZI9zcDUJr7EGfq72chJf\u002BTDMFbXIKGPmhQ5hgPPhBQkDqeMqDh1vZOD3jtvsUhhkTRWjc8AY70iW40\u002BdJUclJz1cLR1gqeM7qoPJ2SWRnnW6y0PuY4Rgfqwgppqt4PvVcsNwhNcrfInYs3MxF36lPVEKUeNDbyOOkEPJHoJ7EjqtjgeOw84ssRjX/Pd696XGy0C7\u002BQRtDFGLZT5Iw2/0b2PA\u002BXQ8W7Dm1AMdxxVTC9B0Jmt7IUn1t9HpzShD2u5Y="}--><title>Experiment s In-Memory OLTP pre high performance registr&#xE1;ciu</title><meta property=og:title content="Experiment s In-Memory OLTP"><meta property=og:description content="Myšlienkový a praktický experiment, ako riešiť systém na registráciu termínov, ktorá odolá veľkej záťaži."><meta property=og:url content=https://harrison314.github.io/InMemoryOltp.html><meta property=og:image content=https://harrison314.github.io/images/InMemoryOltp/InMemorytable.png><meta name=description content="Myšlienkový a praktický experiment, ako riešiť systém na registráciu termínov, ktorá odolá veľkej záťaži."><!--Blazor:{"prerenderId":"8a0f6a30979747bd8584bf404bc19a37"}--><link href=css/bootstrap.min.css rel=stylesheet><link href=css/blog-post.css rel=stylesheet><script type=text/x-mathjax-config>
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel=stylesheet href=css/Highiler/vs.css><style>img{max-width:100%}.img-center{display:block;margin-left:auto;margin-right:auto}</style><body><!--Blazor:{"type":"server","prerenderId":"8f42d22a43a547cda7669fd7860e1e08","key":{"locationHash":"E66163C4CFF76A7FA22AAEDA8B754AB10710C0C1D42652E9DDB330204231FE18:11","formattedComponentKey":""},"sequence":1,"descriptor":"CfDJ8G7p01mvTipOj9seX7mukmuRIvMdciV9veY1FSuqx9N/T4hFSeeYkJL1ujARqlr\u002Bg94zbnX2oSStaSJYsLr2oXoDHmCTmkDMRf0WjpM26\u002BIYTDMrhmp97fqABvUT7Hdy2l/JH17d1W3QD025oHDmUMM\u002BPP9bQfNjtWOhMhzFDk\u002Bouk3lhBVFXvCCGivyhikXA/R1rCvtsy/1tI0\u002B0jVyol7JjPQ7E7Pih9GawPZpo\u002B33GRf7NlNumTvrjlwFNlGrswEgoDSwJ75AgYucBsNk0G3jrVEGWrK/y4UY24\u002BCRLxaA1p\u002BJNIRI5gueZFAa1UcnU\u002BW7O5G5ezvEHMK0DDU7wL4qyoP/CQVhf6UZ5v8kVme/jIfkUHvHAkJAauJkk50CH1dpEG58LpSZNMP0fj0uQU60208tV6oIf15sajFOA9WvEqI0nLzY79wMLDjQRnWlOu/xDKebFILSJ\u002BdLLqqnvhQcS\u002BMQChnQbKlDNubvephet6ZNuGWJiY6MYuxJ/GWCvORNGQBpug1KMf5AQ3rZKGg3xtMSImpuqOCwTtd1O7E"}--><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=index.html>harrison314 blog</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/All.html>Obsah</a><li><a href=/DevelopingAll.html>Programovanie</a><li><a href=/GeneralAll.html>Všeobecné</a><li><a href=/OMne.html>O mne</a></ul></div></div></nav><div class=container><div class=row><div class="col-lg-8 col-md-8"><h1>Experiment s In-Memory OLTP pre high performance registr&#xE1;ciu</h1><div class=publishDate>Janu&#xE1;r 2021</div><p>Po preťažení niektorých informačných systémov v&#160;súvislosti s&#160;Covid testami a&#160;očkovaním som si skúsil najskôr myšlienkový a&#160;neskôr aj&#160;praktický experiment. Rozmýšľal som, ako navrhnúť systém na&#160;registráciu termínov, ktorý&#160;odolá veľkej (nárazovej) záťaži. Ďalšími podmienkami bolo aby&#160;bol systém spoľahlivý (transakčnosť registrácie) a&#160;citlivé dáta neukladal niekde, kde&#160;by nemali byť. Po&#160;preskúmaní rôznych možností a&#160;databáz som sa to pokúsil vyriešiť pomocou technológie <em>In-Memory OLTP</em> v&#160;<em>MS SQL</em>.<h2 id=inspiracia>Inšpirácia</h2><p>17.1.2021 bol na&#160;Slovensku preťažený systém na&#160;objednávanie sa na&#160;antigénové testy. Preťaženie vyvolala okamžitá reakcia ľudí na&#160;tlačovú konferenciu o&#160;celoplošnom skríningu (viac <a href="https://zive.aktuality.sk/clanok/150616/skrining-objednanie-antigenove-testy-testovanie-termin/">tu</a>). V&#160;Česku mali podobné problémy zo&#160;systémom na&#160;registráciu očkovania (<a href=https://twitter.com/ChytraKarantena/status/1349983604571582466>problémy s&#160;Chytrou karanténou</a>).<p>Nechcem tu rozoberať problémy štátneho IT (zhrnutie je možné pozrieť si <a href=https://tech.ihned.cz/c7-66870010-psms7-e882c2115d7c68a>tu</a>). No&#160;je jasné, že&#160;ak službu dizajnujete pre&#160;stovky až tisíce aktívnych používateľov, a&#160;zrazu sa ich tam nahrnie 150-ktát viac, tak to proste padne. Jednou z&#160;chýb bolo to, že&#160;NCZI na&#160;danú situáciu nebolo ani&#160;len upozornené, a&#160;nemalo čas zareagovať. Toto sa nestáva len v&#160;štátnom IT. Niečo podobné sa stalo len pár dní predtým <em>Signalu</em>. Aplikácia <em>WatsApp</em> zmenila podmienky používania a&#160;ochrany súkromia, čo&#160;spôsobilo odliv používateľov k&#160;<em>Signalu</em> a&#160;spôsobili mu <a href="https://zive.aktuality.sk/clanok/150597/signal-mal-v-noci-velky-vypadok-problemy-mozu-pretrvavat/">výpadky</a>.<p>Následne som v&#160;diskusiách a&#160;článkoch na&#160;internete hľadal, ako tento problém vyriešiť – <strong>ako nadizajnosvať systém, aby&#160;vydržal aj&#160;veľkú nárazovú záťaž, pričom používatelia systému sa bijú o&#160;obmedzené zdieľané prostriedky</strong> (termíny na&#160;očkovanie alebo&#160;Ag. testy).<p>Podstatnú časť odpovedí tvorilo <em>„dať to do&#160;cloudu“</em>. Áno sila desiatok serverov znesie veľa, no&#160;jestvujú dosť pádne dôvody, prečo štát nedáva citlivé zdravotnícke dáta na&#160;počítače niekoho iného a&#160;k tomu v&#160;jurisdikcii iného štátu. Plno ďalších odpovedí bolo dokúpiť silné železo, no&#160;to zas treba vysúťažiť&#8230;<p>Tak som sa začal zamýšľať, ako navrhnúť architektúru niečoho, ako systém na&#160;objednávanie na&#160;testy alebo&#160;očkovanie tak, aby&#160;som neodovzdával citlivé dáta tretej strane, a&#160;vystačil si s&#160;klasickými servermi.<h2 id=navrh>Návrh</h2><p>Prvé čo&#160;treba povedať je, že&#160;samotný proces registrácie treba navrhnúť tak, aby&#160;sa procesy, ktoré sú úzke hrdlo vyčlenili na&#160;asynchrónne spracovanie (tu to bolo napríklad odosielanie SMS).<p>Ďalšia kritická oblasť je rezervácia termínu. Pri&#160;veľkej záťaži a&#160;použití klasickej relačnej databázy by dochádzalo k&#160;degradácii výkonu kvôli zámkom nad riadkami tabuľky. No&#160;tu klasická cache nepomôže. Ako riešenie ma napadlo použiť <a href="https://docs.microsoft.com/en-us/sql/relational-databases/in-memory-oltp/in-memory-oltp-in-memory-optimization?view=sql-server-ver15">In-Memory OLTP v&#160;MS SQL</a>.<p>V niektorých prípadoch je vhodné si napísať vlastnú in-memory databázu (tak svoje problémy vyriešilo napríklad <em>Kiwi.com</em> - <a href="https://www.youtube.com/watch?v=lbDp8rd9gzU">https://www.youtube.com/watch?v=lbDp8rd9gzU</a>). Pri&#160;hľadaní riešenia som narazil na&#160;niekoľko databázových enginov napísaných v&#160;jazyku <em>Rust</em>. Proste sa zobral protokol pre&#160;Redis a&#160;k nemu sa doplnila databázová časť. Na&#160;niečo takúto sa Rust hodí, lebo&#160;už kompilátor jazyk a&#160;zabezpečuje pamäťovú bezpečnosť a&#160;thread-safe (nemá garbage collector). Odporúčam sa na&#160;tento jazyk pozrieť. (Napríklad <a href=https://github.com/mambisi/escanor>escanor</a>, <a href=https://github.com/meilisearch/MeiliES>MeiliES</a>,&#8230;).<p>Na nasledujúcom diagrame je znázornená architektúra navrhovaného riešenia.<p><img src=images/InMemoryOltp/Architecture.png class=img-center alt="Architektúra riešenia."><p>Registračná aplikácia bude <em>SPA</em> aplikácia (alebo <em>JAM stack</em>), tak aby&#160;bolo možné hostovať frondend ako statické súbory na&#160;CDN-ku alebo&#160;nezávislom serveri. Pričom je dôležité, aby&#160;klientska aplikácia korektne spracovávala http status <em>429 Too Many Requests</em> retry logikou.<p>Nasleduje load balancer (napríklad <a href=https://en.wikipedia.org/wiki/HAProxy>HAProxy</a>), ktorý&#160;rozdeľuje requesty na&#160;jednotlivé aplikačné inštancie Web API aplikácií, takisto stráži rate limit aby&#160;nedošlo k&#160;preťaženiu Web API inštancií a&#160;korektne vracať http status <em>429</em>. (Poprípade je možné <em>HAProxy</em> doplniť o&#160;<a href=https://learn.hashicorp.com/tutorials/consul/load-balancing-haproxy>Consul</a>.)<p>Inštancie Web API slúžia na&#160;spracovanie registrácií a&#160;obsahujú aplikačnú logiku (v mojom prípade ASP.NET Core 5.0).<p>Databáza (MS SQL 2019) do&#160;ktorej sa ukladajú registrácie. Pričom tabuľka pre&#160;uloženie termínu je duplikovaná na&#160;dve – klasická tabuľka a&#160;in-memory tabuľka (netrpí problémami so&#160;zamykaním riadkov v&#160;tabuľke), kde&#160;sú údaje o&#160;registrácii pre&#160;najvyťaženejšie obdobie (povedzme registrácie na&#160;najbližších 30 dni). Tieto dáta sa synchronizujú v&#160;pravidelných intervaloch pomocou stored procedúr, ktoré volá aplikácia <em>Sheduler App</em>. In-memory tabuľka v&#160;režime <em>SCHEMA_AND_DATA</em> ukladá zmeny aj&#160;na disk, takže v&#160;prípade výpadku serveru nedôjde k&#160;ich strate.<p>A samozrejme nejaké fronta úloh, napríklad pre&#160;odosielanie SMS, ktorá môže byť realizovaná rôznymi spôsobmi (od ukladania v&#160;inej databáze, cez RabbitMQ až po&#160;exotickejšie riešenia – <a href=https://github.com/microsoft/FASTER>FASTER</a>).<p>Čo sa týka samotnej rezervácie termínu, tak by šla vyriešiť tak, že&#160;sa naraz odošlú všetky údaje potrebné údaje, v&#160;in-memory tabuľke sa zaregistruje termín, ostatné dáta sa odložia do&#160;fronty a&#160;spracujú sa neskôr.<h2 id=realizacia>Realizácia</h2><p>Rozhodol som sa, že&#160;si skúsim implementovať časť systému, ktorá sa stará o&#160;rezerváciu termínu na&#160;test, aby&#160;som porovnal priamočiaru implementáciu, ktorú si človek zvolí, keď&#160;rieši bežný systém, voči implementácii s&#160;In-Memory OLTP tabuľkou. Zameral som sa hlavne na&#160;databázovú časť, preto aplikačná logika zostala bez&#160;optimalizácií.<p>Aplikačný server je Web API realizované pomocou <em>ASP.NET Core 5.0</em>. Aplikačná logika je implementovaná pomocou <em>Entity Framewrk Core 5.0</em> a&#160;v prípade In-Memory OLTP tabuľky je volaná jednoduchá stored procedúra cez SQL klienta, implementácia je priamo v&#160;kontroleroch. Inak je použitá defaultná šablóna pre&#160;vytvorenie projektu, takže neboli robené žiadne iné optimalizácie na&#160;strane aplikácie. A&#160;na Web API boli vyvedené ešte&#160;metódy na&#160;generovanie testovacích dát (knižnicou <a href=https://github.com/bchavez/Bogus>Bogus</a>).<p>Databáza je MS SQL 2019.<p>Systém si do&#160;databázy predgeneruje termíny na&#160;registráciu (karteziánsky súčin medzi odberovými/očkovacími miestami, dátumom a&#160;časom v&#160;rámci dňa).<p>DDL pre&#160;registračnú in-memory tabuľku vyzerá takto:<div class="lang-sql editor-colors"><div style=color:Black;background-color:White><pre>
<span style=color:Blue>CREATE</span> <span style=color:Blue>TABLE</span> [dbo].[RegistrationInMemory]
(
	[Day] [DATETIME2](7) <span style=color:Blue>NOT</span> <span style=color:Blue>NULL</span>,
	[TimeSlotId] [INT] <span style=color:Blue>NOT</span> <span style=color:Blue>NULL</span>,
	[PlaceId] [INT] <span style=color:Blue>NOT</span> <span style=color:Blue>NULL</span>,
	[CovidClientId] [INT] <span style=color:Blue>NULL</span>,
	[Register] [DATETIME2](7) <span style=color:Blue>NULL</span>,

    <span style=color:Blue>CONSTRAINT</span> [PK_RegistrationInMemory] <span style=color:Blue>PRIMARY</span> <span style=color:Blue>KEY</span> <span style=color:Blue>NONCLUSTERED</span> 
    (
    	[Day] <span style=color:Blue>ASC</span>,
    	[TimeSlotId] <span style=color:Blue>ASC</span>,
    	[PlaceId] <span style=color:Blue>ASC</span>
    ),
    <span style=color:Blue>INDEX</span> [RegistrationInMemory_Sorting_IX] <span style=color:Blue>NONCLUSTERED</span> 
    (
    	[Day] <span style=color:Blue>ASC</span>,
    	[TimeSlotId] <span style=color:Blue>ASC</span>,
    	[PlaceId] <span style=color:Blue>ASC</span>
    )
) <span style=color:Blue>WITH</span> (MEMORY_OPTIMIZED = <span style=color:Blue>ON</span>, DURABILITY = SCHEMA_AND_DATA);
</pre></div></div><p>Primárny kľúč tvorí kombinácia dátumu, času v&#160;rámci dňa a&#160;odberového/očkovacieho miesta, pre&#160;rýchle vyhľadanie pri&#160;registrácii.<p>Ďalší index slúži pri&#160;vyhľadávaní voľných termínov a&#160;ich zobrazení v&#160;rámci dňa alebo&#160;týždňa.<p>Natívne kompilovaná stored procedúra pre&#160;registráciu termínu vyzerá nasledovne:<div class="lang-sql editor-colors"><div style=color:Black;background-color:White><pre>
<span style=color:Blue>CREATE</span> <span style=color:Blue>PROCEDURE</span> [dbo].[RegistrationInMemory_TryRegister]
	@date DATETIME2,
	@slotId <span style=color:Blue>INT</span>,
	@placeId <span style=color:Blue>INT</span>,
	@covidClientId <span style=color:Blue>INT</span>
<span style=color:Blue>WITH</span> NATIVE_COMPILATION, SCHEMABINDING
<span style=color:Blue>AS</span> <span style=color:Blue>BEGIN</span> ATOMIC <span style=color:Blue>WITH</span>
(
 <span style=color:Blue>TRANSACTION</span> <span style=color:Blue>ISOLATION</span> <span style=color:Blue>LEVEL</span> = SNAPSHOT, <span style=color:Blue>LANGUAGE</span> = N<span style=color:#A31515>&#39;us_english&#39;</span>
)
  
  <span style=color:Blue>DECLARE</span> @isRegistered <span style=color:Blue>BIT</span> = 0;

  <span style=color:Blue>UPDATE</span> [dbo].[RegistrationInMemory]
      <span style=color:Blue>SET</span> @isRegistered = 1,
          [CovidClientId] = @covidClientId,
          [Register] = <span style=color:Magenta>GETDATE</span>()
      <span style=color:Blue>WHERE</span> [Day] = @date <span style=color:Blue>AND</span> [TimeSlotId] = @slotId <span style=color:Blue>AND</span> [PlaceId] = @placeId <span style=color:Blue>AND</span> [CovidClientId] <span style=color:Blue>IS</span> <span style=color:Blue>NULL</span>;

  <span style=color:Blue>SELECT</span> @isRegistered <span style=color:Blue>AS</span> [RegistrationSuccessfull];
<span style=color:Blue>END</span>
</pre></div></div><p>Vo výsledku vráti, či&#160;sa podarilo používateľa registrovať na&#160;zvolený termín.<p>Výhody použitia In-Memory OLTP voči napríklad Redisu sú hlavne v&#160;tranzakčnosti presúvania dát do&#160;klasických tabuliek, možnosť písať natívne kompilované procedúry a&#160;dodatočné indexy (v Redise by ich bolo nutné implementovať aplikačne).<h2 id=vysledky>Výsledky</h2><p>Záťažové testovanie som robil na&#160;notebooku s&#160;procesorom <em>Inter Core i7-8550U 1.80GHz</em>, <em>8GB</em> RAM a&#160;SSD diskom na&#160;operačnom systéme <em>Windows 10 Pro verzia 2004</em>.<p>Použil som naň nástroj <a href=https://github.com/hallatore/Netling>Netling</a> a&#160;testovacie GET metódy kontroleru vyberali náhodné termíny na&#160;náhodných miestach pre&#160;registráciu.<p>Zaujímavé zistenie bolo, že&#160;v in-memory tabuľke dáta aj&#160;s indexami pre&#160;5 000 000 termínov na&#160;registráciu zaberali približne 1GB z&#160;RAM.<p>Pri klasickom použití tabuľky a&#160;Entity Frameworku (načítanie termínu a&#160;jeho modifikácia) som sa dostal na&#160;priepustnosť 1 386 requestov za&#160;sekundu. (Snímka okna nižšie.)<p><img src=images/InMemoryOltp/SqlTable.png class=img-center alt="Výsledky použitia klasickej tabuľky."><p>Pri použití In-Memory tabuľky volanej cez SQL klienta som sa dostal na&#160;priepustnosť 10 069 requestov za&#160;sekundu. Čo&#160;už je slušné číslo na&#160;aplikáciu bez&#160;akýchkoľvek optimalizácií. Pri&#160;in-memory tabuľke bolo úzke hrdlo procesor. (Snímka okna nižšie.)<p><img src=images/InMemoryOltp/InMemorytable.png class=img-center alt="Výsledky použitia klasickej tabuľky."><p><strong>Poznámky</strong>: Rozdiel v&#160;rýchlosti medzi <em>Entity Frameowrkom Core 5</em> a&#160;priamom prístupom (SQL klient) je zanedbateľný. Vysoké čísla a&#160;nízku latenciu považujem za&#160;výsledok toho, že&#160;som testoval na&#160;rovnakom notebooku ako bežal server a&#160;teda odpadáva sieťová latencia. Relatívne malý bandwidth je spôsobený testovaním pomocou NETLING-u, využíva len GET požiadavky.<h2 id=zaver>Záver</h2><p>Dlho som hľadal nejaký reálny use-case pre&#160;technológiu In-Memory OLTP, konečne sa mi ju podarilo vyskúšať. Dosť príjemne ma prekvapili čísla performace aj&#160;množstvo zabranej pamäte. <strong>Desaťtisíc spracovaných requestov za&#160;sekundu som nečakal.</strong><p>No musím podotknúť, že&#160;som prakticky riešil len malú časť systému a&#160;taktiež môj experiment ignoruje sieťovú latenciu. Takže vo výsledku by na&#160;strane aplikácie tých requetsov bolo spracovaných menej.<p>Do pozornosti ešte&#160;dávam prednášku o&#160;tom, ako spracovávať Big Data v&#160;MS SQL - <a href=https://wug.cz/zaznamy/503-SQL-Server-Bootcamp-2018-Zpracovavejte-velka-data-v-SQL-Serveru-rychlosti-blesku>https://wug.cz/zaznamy/503-SQL-Server-Bootcamp-2018-Zpracovavejte-velka-data-v-SQL-Serveru-rychlosti-blesku</a> a&#160;architektúru <a href=https://docs.microsoft.com/en-us/azure/architecture/patterns/cqrs>CQRS</a>.<h3 id=neskorsia-optimalizacia>Neskoršia optimalizácia</h3><p>Po napísaní tohto blogu (január 2021) som sa k&#160;problematike o&#160;mesiac vrátil. Skúšal som iné optimalizácie, niektoré úspešne a&#160;iné menej úspešne. Uvádzam ich takto mimo hlavného obsahu, lebo&#160;nespĺňajú požiadavky zadefinované v&#160;úvode.<p>Menej úspešne dopadol pokus o&#160;použitie prístupu <em>Event store</em>, hlavne pre&#160;to, že&#160;kvôli požiadavkám som musel obchádzať niektoré jeho princípy a&#160;taktiež som naň nevedel rýchlo napísať vhodné transakčné úložisko a&#160;notifikáciu používateľa.<br> (Mal som obmedzený čas a&#160;databázu <a href="https://www.eventstore.com/">EventStore</a> som neskúšal.)<p>Priamy zápis údajov do&#160;Redis-u cez ASP.NET Core kontroller mi dal približne 14 500 requetsov za&#160;sekundu.<p>Priamy zápis do&#160;Redis-u cez vlastný ASP.NET Core middleware, ktorý&#160;zastupoval REST endpoint, dokázal spracovať približne 36 000 requestov za&#160;sekundu.<p>Priamy zápis do&#160;Redisu pomocou natívnej aplikácii napísanej v&#160;Rust-e pomocou frameworku <a href="https://actix.rs/">Actix</a> a&#160;knižnici <a href="https://github.com/pooyamb/actix-storage/">actix-storage-redis</a> mi dokázalo spracovať tiež okolo 36 000 requestov za&#160;sekundu. Rust bol rýchlejší o&#160;niekoľko málo stoviek requestov.<p>Priamy zápis do&#160;MS SQL In-Memory OLTP tabuľky cez vlastný ASP.NET Core middleware, ktorý&#160;zastupoval REST endpoint, dokázal spracovať 15 000 requestov za&#160;sekundu. To je v&#160;tomto prípade o&#160;<em>50%</em> viac ako cez kontroller. A&#160;ako jediné riešenie z&#160;tejto kapitoly spĺňa požiadavky zadefinované v&#160;úvode, no&#160;nevýhoda je, že&#160;sa takýto endpoint neobjaví v&#160;OpenAPI špecifikácii.</div><div class="col-lg-4 col-md-4 hidden-xs hidden-sm"><div class=well><h4>V&#xFD;voj</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/PostKvantovaKryptografia.html>Post-kvantov&#xE1; kryptografia v C#</a><li><a href=/BouncyHsm.html>Ako som robil BouncyHsm</a><li><a href=/BuildAutomation.html>Pre&#x10D;o pou&#x17E;&#xED;va&#x165; build automation</a><li><a href=/KeyValueDB.html>Ako na Key-Value datab&#xE1;zu</a><li><a href=/RankFunctions.html>MS SQL a RANK funkcie</a><li><a href=/MongoDbVsRavenDb.html>MongoDB vs. RavenDB</a><li><a href=/WinHttp.html>Pou&#x17E;itie WinHTTP</a><li><a href=/BinaryContentInApi.html>ASP.NET Core API a bin&#xE1;rny obsah</a><li><a href=/PerformaceInNet.html>Meranie performace pre dotnetistov</a><li><a href=/CngApiTips.html>Triky s Windows CNG API</a><li><a href=/DevelopingAll.html>&#8230;</a></ul></div></div></div><div class=well><h4>V&#x161;eobecn&#xE9;</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/EzoGenerator.html>Gener&#xE1;tor Ezo textov</a><li><a href=/AlternativnyRecept.html>Propag&#xE1;cia alternat&#xED;vnej medic&#xED;ny</a><li><a href=/VotrelciDavnoveku.html>Votrelci d&#xE1;vnoveku</a><li><a href=/GeneralAll.html>&#8230;</a></ul></div></div></div><div class=well><h4>O mne</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/VyvojarskeOdkazy.html>Moje vyvojarske blogy</a><li><a href=/OMne.html>O mne</a><li><a href=/OMneOdkazy.html>Moja tvorba inde</a><li><a href=/Portfolio.html>Portólio</a></ul></div></div></div></div></div><hr><footer><div class="row no-print"><div class="col-lg-8 col-sm-8"><div class=well><h4>Našli ste chybu, alebo chcete niečo doplniť?</h4><p>Ak ste našli chybu v článu, chcete niečo dopniť, alebo sa vyjadriť k téme, môžete na <a href="https://github.com/harrison314/harrison314.github.io/issues/new?title=Experiment%20s%20In-Memory%20OLTP&amp;body=https%3A%2F%2Fharrison314.github.io%2FInMemoryOltp.html" target=_blank>Githube otvoriť issue</a>.</div></div></div><div class=row><div class=col-lg-12><p>Copyright &copy; harrison314 2013<span class=on-print> - https://harrison314.github.io/</span></div></div></footer></div><!--Blazor:{"prerenderId":"8f42d22a43a547cda7669fd7860e1e08"}--><script src=js/jquery.js></script><script src=js/bootstrap.min.js></script><!--Blazor-Server-Component-State:CfDJ8G7p01mvTipOj9seX7mukmv05er7zcj1ksB/73v4ZfT86O5h9FSv9wxtpIXx6vRb97i3WmbMKj6Q9YaUrFkuLIwhnghqKVwOudVELmkO230mNGbuqJ+plQFGOCKcytKtqUAKu0nhcCrTsVXtai2AC+s6fjr64eSAKTix1N+Yl7xBj7qIajdswElEF7U0BFPh0r9GxsgGNUHwG7V5zg0sO3KB9OSP6zfaYN+P0Bf5lJhbkuS/q29ckZZWP9jH14HFxxTUS9y9vsGVv08M/cZLndkrJDl93v6LmKIsRZA0wFY2BYd4SwDsXwnjlfqkZKSkdqV8rErHN0xN8fbz1UN0w3QkwATU9jDBSRmISy9yfJ2HsDLuoxMP+MjQ8TUkeSKHdeSWzQgQEZK2bg+eTHNkcFf9Nt5bXEVp4CFT74yYlv45l0amqY4wf7DFS9c9GPWE/tPqrrD/3FzueeYAYVrNVG9yPrIt7l9ma6eXSUPJsG0ekkxZHU06kMjO4P7rkANxVa1ZKq9Fnmz/r95Yz3lDIi4pd4mMHa02clP9gQpwQvHF-->