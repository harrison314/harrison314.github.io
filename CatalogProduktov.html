<!DOCTYPE html><html lang=sk><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=X-Xss-Protection content="1; mode=block"><meta http-equiv=X-Content-Type-Options content=nosniff><meta name=viewport content="width=device-width, initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed" href=feed.rss><meta name=author content=harrison314><meta name=generator content=AspNetStatic><title>Katal&#xF3;g produktov v rela&#x10D;nej datab&#xE1;ze</title><meta property=og:title content="Katalóg produktov v relačnej databáze"><meta property=og:description content="Rekapitulácia tvorby dynamickej dátovej štruktúry v databázach z mojich školských čias."><meta property=og:url content=https://harrison314.github.io/CatalogProduktov.html><meta name=description content="Rekapitulácia tvorby dynamickej dátovej štruktúry v databázach z mojich školských čias."><link href=css/bootstrap.min.css rel=stylesheet><link href=css/blog-post.css rel=stylesheet><script type=text/x-mathjax-config>
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel=stylesheet href=css/Highiler/vs.css><style>img{max-width:100%}.img-center{display:block;margin-left:auto;margin-right:auto}</style><body><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=index.html>harrison314 blog</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/All.html>Obsah</a><li><a href=/DevelopingAll.html>Programovanie</a><li><a href=/GeneralAll.html>Všeobecné</a><li><a href=/OMne.html>O mne</a></ul></div></div></nav><div class=container><div class=row><div class="col-lg-8 col-md-8"><h1>Katal&#xF3;g produktov v rela&#x10D;nej datab&#xE1;ze</h1><div class=publishDate>December 2013</div><p>Tvorba katalógov produktov a&#160;služieb je veľmi časté, či&#160;už na&#160;webe alebo&#160;v podnikovej sfére. Požiadavkou na&#160;takýto systém je aby&#160;umožňoval ukladať tovar s&#160;rôznymi atribútmi ako rozmery, cena, pri&#160;niektorých typoch produktov farba, pri&#160;iných výkon. Predstavte si e-shop s&#160;elektronikou, pri&#160;reproduktoroch je uvedený výkon, rozmery, dostupná farba, no&#160;pri stolných počítačoch je tam procesor, veľkosť pamäte, zas pri&#160;monitore uhlopriečka&#8230;<p>V tomto článku chcem v&#160;krátkosti predstaviť možné riešenia.<h2 id=naivne-riesenie>Naivné riešenie</h2><p>Pre každý typ tovaru sa vytvorí osobitná tabuľka. Zvrátenosť tohto riešenia sa ukáže pri&#160;18-tich druhoch tovaru a&#160;vo väzbách na&#160;18 ďalších tabuliek (žiaľ reálna skúsenosť). Toto riešenie je absolútne nevhodné z&#160;hľadiska normalizácie a&#160;neschopnosti meniť typy produktov počas „behu“.<h2 id=pouzitie-orm>Použitie ORM</h2><p>Bavíme sa o&#160;použití ORM podporujúceho dedenie a&#160;polymorfizmus entít (napr. <em>Entity Framework</em> alebo&#160;<em>Hibernate</em> ), žiadne trápne <em>active record</em>. Tovar je reprezentovaný ako abstraktná entita, samotné druhy tovaru sú vytvorené dedením. Toto riešenie je pekné v&#160;tom, že&#160;ORM a&#160;polymorfizmus spraví za&#160;nás všetku špinavú prácu, no&#160;stále nie je možné po&#160;nasadení aplikácie meniť typ tovaru.<h2 id=pouzitie-nosql-databazy>Použitie NoSQL databázy</h2><p>Bezschémové databázy (napr. <em>MongoDB</em>, <a href="http://docs.mongodb.org/ecosystem/use-cases/product-catalog/">katalóg v&#160;MongoDB</a> ) umožňujú vkladať a&#160;vyťahovať tovar do&#160;a z&#160;databázy s&#160;rôznymi atribútmi. Dokonca je možné danú schému meniť po&#160;nasadení aplikácie, pridávať nové druhy tovaru. Toto je jeden z&#160;argumentov priaznivcov NoSQL databáz. Jednoducho navrhnete „schému“ tak ako vyzerajú najčastejšie „dopyty“. Praktickej ukážke sa môžem povenovať niekedy nabudúce, no&#160;v tomto článku chcem ukázať ako daný problém riešiť pomocou relačnej databázy.<h2 id=riesenie-z-mudrej-knihy-eav>Riešenie z&#160;múdrej knihy (EAV)</h2><p>Návrhové vzory sú všeobecné riešenia problémov v&#160;danom kontexte. Niečo podobné jestvuje aj&#160;pre návrh databázových schém a&#160;volá sa to analytické vzory. V&#160;múdrej knihe (1) som narazil na&#160;vzor <em>Predmet zmluvy</em>, ktorý&#160;spĺňa všetko to čo&#160;potrebujeme a&#160;vzory pre&#160;cenníky produktov.<p>Výsledok je takáto databázová schéma:<p><img src=images/CatalogProduktov/Eav.png class=img-center alt="katalog v1.jpg"><p>Ide naozaj o&#160;abstraktný návrh, ktorý&#160;treba trochu ohnúť pre&#160;každé konkrétne použitie.<p><em>Katalog</em> – táto entita predstavuje konkrétny katalóg, pravdepodobne bude mať svoje meno ( <strong>„Katalóg jeseň-zima 2013“</strong> ) a&#160;svoju časovú pôsobnosť. S&#160;produktom má reláciu N ku&#160;N, pretože&#160;predpokladám, že&#160;ten istý produkt sa môže vyskytovať v&#160;rôznych katalógoch.<p><em>Produkt</em> – obsahuje len meno produktu. Je otázne, či&#160;má obsahovať aj&#160;atribúty, ktoré sú pre&#160;všetky produkty spoločné (napríklad cena).<p><em>TypProduktu</em> – reprezentuje typy produktov. Produktu určuje typ a&#160;tým aj&#160;to aké má vlastnosti. (Typ môže byť: PC, televízor, mixér,&#8230;.).<p><em>TypVlastnostiProduktu</em> – entita určuje typ vlastnosti produktu, môže ísť o&#160;cenu, farbu tovaru, hmotnosť&#8230; Má reláciu k&#160;<em>TypProduktu</em> typu N ku&#160;N, pretože&#160;rôzny typy produktov môžu byť opísané rovnakými vlastnosťami. Pravdepodobne každý typ produktu bude mať cenu, pri&#160;chladničkách a&#160;televízoroch to môže byť hmotnosť.<p><em>TypHodnoty</em> – reprezentuje akého typu je vlastnosť produktu. Napríklad ak ide o&#160;hmotnosť televízora, tak typ je číselný atribút, a&#160;uvádza sa v&#160;kilogramoch. Spolu s&#160;týmito informáciami je možné do&#160;tejto entity ukladať aj&#160;ohraničenia pre&#160;hodnoty vlastností produktov ako napr. číselný rozsah. Za&#160;istých okolností je vhodnejšie entitu <em>TypHodnoty</em> a&#160;<em>TypVlastnosťiPruktu</em> zlúčiť, no&#160;to záleží už od&#160;konkrétneho návrhu.<p>Entity <em>TypProduktu</em>, <em>TypVlastnostiProduktu</em> a&#160;<em>TypHodnoty</em>, tvoria metaúroveň produktov. Pomocou nej je možné automaticky generovať formuláre pre&#160;zadávanie nových produktov. Typ produktu je možné považovať súčasne aj&#160;za kategóriu produktu a&#160;vytvoriť z&#160;neho menu, alebo&#160;pridaním rekurzívnej relácie stromovú štruktúru typov/kategórií produktov.<p><em>VlastnostProduktu</em> – táto entita obsahuje už hodnoty vlastností produktu.<p><strong>Poznámka:</strong> V&#160;praxi sa používa aj&#160;riešenie, obsahujúce tabuľky profilov produktov a&#160;jednu veľkú tabuľku hodnôt, ktorá pre&#160;každý dátový typ (int, double, krátky text, dlhý text) <em>N</em> (napr. 10) stĺpcov. V&#160;profile typu sa uchováva ktoré stĺpce reprezentujú akú položku produktu. Bližšie o&#160;tomto spôsobe dopíšem neskôr.<h2 id=zaver>Záver</h2><p>Posledné uvedené riešenie umožňuje do&#160;relačnej databázy uložiť takmer čokoľvek, čo&#160;sa aspoň trochu podobá na&#160;zadanie v&#160;úvode. No&#160;je potrebné viac premyslieť selkty, tiež odporúčam nejaké to cachovanie.<h2 id=zdroje>Zdroje</h2><ol><li>Šešera Ľubor RNDr. PhD., Aplikačné architektúry softvérových systémov, ISBN 978-227-3652-7<li><a href="http://docs.mongodb.org/ecosystem/use-cases/product-catalog/">http://docs.mongodb.org/ecosystem/use-cases/product-catalog/</a></ol></div><div class="col-lg-4 col-md-4 hidden-xs hidden-sm"><div class=well><h4>V&#xFD;voj</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/1brc.html>One Billion Rows Challenge</a><li><a href=/MigraciaBlogu.html>Migr&#xE1;cia blogu</a><li><a href=/PostKvantovaKryptografia.html>Post-kvantov&#xE1; kryptografia v C#</a><li><a href=/BouncyHsm.html>Ako som robil BouncyHsm</a><li><a href=/BuildAutomation.html>Pre&#x10D;o pou&#x17E;&#xED;va&#x165; build automation</a><li><a href=/KeyValueDB.html>Ako na Key-Value datab&#xE1;zu</a><li><a href=/RankFunctions.html>MS SQL a RANK funkcie</a><li><a href=/MongoDbVsRavenDb.html>MongoDB vs. RavenDB</a><li><a href=/WinHttp.html>Pou&#x17E;itie WinHTTP</a><li><a href=/BinaryContentInApi.html>ASP.NET Core API a bin&#xE1;rny obsah</a><li><a href=/DevelopingAll.html>&#8230;</a></ul></div></div></div><div class=well><h4>V&#x161;eobecn&#xE9;</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/EzoGenerator.html>Gener&#xE1;tor Ezo textov</a><li><a href=/AlternativnyRecept.html>Propag&#xE1;cia alternat&#xED;vnej medic&#xED;ny</a><li><a href=/VotrelciDavnoveku.html>Votrelci d&#xE1;vnoveku</a><li><a href=/GeneralAll.html>&#8230;</a></ul></div></div></div><div class=well><h4>O mne</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/VyvojarskeOdkazy.html>Moje vyvojarske blogy</a><li><a href=/OMne.html>O mne</a><li><a href=/OMneOdkazy.html>Moja tvorba inde</a><li><a href=/Portfolio.html>Portólio</a></ul></div></div></div></div></div><hr><footer><div class="row no-print"><div class="col-lg-8 col-sm-8"><div class=well><h4>Našli ste chybu, alebo chcete niečo doplniť?</h4><p>Ak ste našli chybu v článu, chcete niečo dopniť, alebo sa vyjadriť k téme, môžete na <a href="https://github.com/harrison314/harrison314.github.io/issues/new?title=Katal%C3%B3g%20produktov%20v%20rela%C4%8Dnej%20datab%C3%A1ze&amp;body=https%3A%2F%2Fharrison314.github.io%2FCatalogProduktov.html" target=_blank>Githube otvoriť issue</a>.</div></div></div><div class=row><div class=col-lg-12><p>Copyright &copy; harrison314 2013<span class=on-print> - https://harrison314.github.io/</span></div></div></footer></div><script src=js/jquery.js></script><script src=js/bootstrap.min.js></script>