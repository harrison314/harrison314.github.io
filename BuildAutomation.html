<!DOCTYPE html><html lang=sk><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=X-Xss-Protection content="1; mode=block"><meta http-equiv=X-Content-Type-Options content=nosniff><meta name=viewport content="width=device-width, initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed" href=feed.rss><meta name=author content=harrison314><meta name=generator content=AspNetStatic><title>Pre&#x10D;o pou&#x17E;&#xED;va&#x165; build automation</title><meta property=og:title content="Prečo používať build automation"><meta property=og:description content="Prečo používať build automation tooly a predstavenie Cake Build a NUKE."><meta property=og:url content=https://harrison314.github.io/BuildAutomation.html><meta property=og:image content=https://harrison314.github.io/images/BuildAutomation/media.png><meta name=description content="Prečo používať build automation tooly a predstavenie Cake Build a NUKE."><link href=css/bootstrap.min.css rel=stylesheet><link href=css/blog-post.css rel=stylesheet><script type=text/x-mathjax-config>
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel=stylesheet href=css/Highiler/vs.css><style>img{max-width:100%}.img-center{display:block;margin-left:auto;margin-right:auto}</style><body><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=index.html>harrison314 blog</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/All.html>Obsah</a><li><a href=/DevelopingAll.html>Programovanie</a><li><a href=/GeneralAll.html>Všeobecné</a><li><a href=/OMne.html>O mne</a></ul></div></div></nav><div class=container><div class=row><div class="col-lg-8 col-md-8"><h1>Pre&#x10D;o pou&#x17E;&#xED;va&#x165; build automation</h1><div class=publishDate>J&#xFA;l 2023</div><p>Za svoju kariéru som sa stretol s&#160;rôznym spôsobom ako buldovať dotnetovské projekty, od&#160;použitia <em>Visual Studia</em>, cez <em>.bat</em> súbory, <em>Powershell</em> a&#160;nakoniec som skončil pri&#160;build automation tooloch (konkrétne <em>Cake</em> a&#160;<em>Nuke</em>).<p>Späť by som sa už nevrátil. Prečo? <strong>Lebo tieto nástroje šetria čas a&#160;nervy.</strong><h2 id=co-je-to-build-automation-tool>Čo je to build automation tool</h2><p>Pri vytvorení artefaktov projektu nejde len o&#160;to niečo skompilovať, treba s&#160;tým spraviť plno iných drobných vecí. To zahŕňa odstránenie starých artefaktov, kompiláciu závislých projektov, podpísanie binárok, konverziu dokumentácie do&#160;vhodného formátu, pridanie ďalších súborov do&#160;projektu (licencie, vygenerované SQL migrácie, konfiguráciu,&#8230;) a&#160;nakoniec vytvorenie balíčkov pre&#160;inštaláciu (<em>zip</em>, <em>msi</em>, <em>deb</em>,&#8230;) a&#160;nezabudnúť ju správne pomenovať.<p>K tomu celému je často v&#160;projekte viac výsledných inštalačných balíkov a&#160;nugetov. Taktiež je pred tým potrebné pustiť unit testy, či&#160;zaistiť rozdielne správanie pre&#160;release a&#160;prerelease build.<p>A práve tieto úlohy dokáže automatizovať build automation tool. Nie je to kompilátor, je o&#160;úroveň vyššie.<p class="text-center font-italic" :=""><img src=images/BuildAutomation/plan.png class=img-center alt="Znázornenie targetov v NUKE."> Znázornenie závislostí medzi úlohami - NUKE (<a href=https://ithrowexceptions.com/2020/06/05/reusable-build-components-with-interface-default-implementations.html>zdroj</a>).<h2 id=preco-pouzivat-build-automation>Prečo používať build automation</h2><p>&#8230; pre&#160;.NET (aj v&#160;porovnaní so&#160;štandardami CI/CD pipelinami):<ul><li>zdieľanie vedomostí v&#160;tíme a&#160;zastupiteľnosť kolegov,<li>build všetkých projektov sa spúšťa rovnako,<li>build funguje rovnako lokálne u vývojára ako na&#160;build serveri,<li>proces buildovania je možné odladiť lokálne (v gite nebude tisíc komitov pre&#160;úpravu YAML definície pipeline – do&#160;YAML proste breakpoint nedáš) ,<li>zníženie vendor-locku (nie je to napísané vo vendor špecifickej YAML pipeline), pri&#160;použití CI/CD je potrebný YAML jednoduchý (len spúšťa build automation tool), rovnakú definíciu je možné použiť na&#160;väčšinu projektov a&#160;napísať túto definíciu pre&#160;iného vendora nie je náročné,<li>pomocou targetov je možné spustiť rozne úlohy v&#160;CI/CD pipleine (napr. <em>test</em>, <em>build</em>, <em>publish</em>,&#8230;),<li>žiadne magické stringy, žiadne skryté požiadavky a&#160;menej prekvapení,<li>nie je to mágia, ale&#160;známy jazyk a&#160;knižnice a&#160;dokonca aj&#160;IDE.</ul><p>V podstate celý proces buildovania (vrátane testov a&#160;uploadu artefaktov) sme presunuli z&#160;„ručnej roboty“ alebo&#160;YAML-u do&#160;programu, ktorému rozumieme.<h2 id=cake-a-nuke>Cake a&#160;NUKE</h2><p><em>Cake</em> (C# Make) a&#160;<em>NUKE</em> sú oba build automation tooly pre&#160;.NET a&#160;MS Build. Oba viac menej dokážu to isté a&#160;podobným spôsobom.<p>Čo majú spoločné:<ul><li>pre inicializáciu používajú .NET global tool,<li>sú multiplatformové,<li>majú slušnú komunitu,<li>ide o&#160;DSL nad jazykom C# (závislosti, úlohy, cleanup, buildovanie, práca so&#160;súbormi, globing, version control, notifikácie,&#8230;),<li>vedia buildovať aj&#160;iné ako .NET projekty,<li>orientujú sa na&#160;úlohy (tasky/targety) so&#160;vzájomnými závislosťami,<li>ich funkcionalita ide rozšíriť pomocou nugetov (stále je to C#),<li>zdieľanie kódu je tiež možné pomocou nugetov,<li>majú podporu najznámejších test runnerov,<li>dokážu artefakty deploynúť a&#160;nasadiť (to sa často nepoužíva),<li>majú širokú podporu rozšírení a&#160;toolov (<em>dotnet</em>, <em>MS Build</em>, <em>node.js</em>, <em>EsLint</em>, <em>upack</em>, <em>Docker</em>, <em>OpenCover</em>, <em>Sonarqube</em>, <em>git</em>, <em>Wix</em>, <em>Yarn</em>,&#8230;),<li>majú dobre vyriešené logovanie.</ul><p>Čo majú rozdielne:<ul><li><em>Cake</em> je napísaný ako „skript“ (v <em>.cake</em> súbore – vie s&#160;ním pracovať <em>Visual Studio Code</em>, plus je na&#160;to plugin),<li><em>NUKE</em> používa .NET projekt priamo v&#160;solution (takže natívna podpora IDE),<li>ku rozšíriteľnosti pristupujú trochu inak,<li>príde mi, že&#160;<em>Cake</em> má viac extrených toolov/addonov,<li><em>Cake</em> je vhodnejšie aj&#160;pre projekty s&#160;<em>.Net Frameworkom</em>,<li><em>NUKE</em> dokaźe deklaratívne používať dotnet global tools,<li><em>NUKE</em> dokáže parsovať <em>.sln</em> a&#160;<em>.csproj</em> súbory,<li><em>NUKE</em> vie generovať YAML súbory pre&#160;známe CI/CD riešenia.</ul><h3 id=cake>Cake</h3><table class="table table-borderless"><tbody><tr><td class=col-md-4>Stránka<td class=col-md-8><a href="https://cakebuild.net/" target=_blank>https://cakebuild.net/</a></td><tr><td class=col-md-4>Ako začať<td class=col-md-8><a href=https://cakebuild.net/docs/getting-started/setting-up-a-new-scripting-project target=_blank>https://cakebuild.net/docs/getting-started/setting-up-a-new-scripting-project</a></td><tr><td class=col-md-4>Github<td class=col-md-8><a href=https://github.com/cake-build/cake target=_blank>https://github.com/cake-build/cake</a></td><tr><td class=col-md-4>Integrácia na&#160;treťostranné baličky<td class=col-md-8><a href="https://cakebuild.net/extensions/" target=_blank>https://cakebuild.net/extensions/</a></td><tr><td class=col-md-4>Ukážka použitia<td class=col-md-8><a href=https://github.com/harrison314/PkcsExtensions/blob/master/build/build.cake target=_blank>https://github.com/harrison314/PkcsExtensions/blob/master/build/build.cake</a></td></table><h3 id=nuke>NUKE</h3><table class="table table-borderless"><tbody><tr><td class=col-md-4>Stránka<td class=col-md-8><a href="https://nuke.build/" target=_blank>https://nuke.build/</a></td><tr><td class=col-md-4>Ako začať<td class=col-md-8><a href="https://nuke.build/docs/getting-started/installation/" target=_blank>https://nuke.build/docs/getting-started/installation/</a></td><tr><td class=col-md-4>Github<td class=col-md-8><a href=https://github.com/nuke-build/nuke target=_blank>https://github.com/nuke-build/nuke</a></td><tr><td class=col-md-4>Integrácia na&#160;treťostranné baličky<td class=col-md-8><a href="https://nuke.build/docs/common/cli-tools/" target=_blank>https://nuke.build/docs/common/cli-tools/</a></td><tr><td class=col-md-4>Ukážka použitia<td class=col-md-8><a href=https://github.com/harrison314/Area52/blob/main/build/BuildProject/Build.cs target=_blank>https://github.com/harrison314/Area52/blob/main/build/BuildProject/Build.cs</a></td></table><h2 id=ktory-si-vybrat>Ktorý si vybrať?</h2><p>Typický príklad použitia týchto nástrojov je, že&#160;pri release builde sa spustia unit testy, do&#160;buildu sa vrazí git komit a&#160;nejaké premenné prostredia, výsledok sa zozipuje, dopíše sa verzia a&#160;niekde sa uploadne artefakt. Na&#160;čo bohate stačia oba tieto nástroje.<p>Oba tieto tooly sú dobré a&#160;dokážu podobné veci trochu iným prístupom. Čokoľvek, čo&#160;ide spraviť v&#160;C# ide spraviť aj&#160;pomocou týchto nástrojov.<p><em>NUKE</em> je viac deklaratívne, tým ma človek ľahší začiatok a&#160;pokiaľ netreba naozaj špeciálne veci tak bohate stačí. Taktiež je príjemné mať intellisense vďaka tomu, že&#160;ide o&#160;konzolovú aplikáciu v&#160;rámci solution.<p><em>Cake</em> je viac imperatívne, osobne ho používam o&#160;dosť dlhšie a&#160;možno aj&#160;pre to mi príde trochu univerzálnejšie, navyše vyhráva v&#160;počte integrácii na&#160;treťostranné služby a&#160;programy.<h2 id=zaver>Záver</h2><p>Myslím, že&#160;keď si človek vyberie hociktorý nástroj (<em>Cake</em>, <em>NUKE</em>), tak na&#160;začiatku nespraví chybu. Navyše kód pre&#160;build automation nebýva dlhý, tak to ide ľahko prepísať.<p>A ako som spomínal, už len samotné použitie takéhoto nástroja šetrí čas a&#160;nervy.<p>Osobne mi tieto nástroje priniesli hlavne to, že&#160;si viem buildy rýchlo odladiť lokálne. A&#160;keď som na&#160;dovolenke, tak mi nemusí nik volať ohľadom buidlovania knižnice <em>XY</em>, ktorú nutne potrebuje na&#160;vyriešenie bugu.</div><div class="col-lg-4 col-md-4 hidden-xs hidden-sm"><div class=well><h4>V&#xFD;voj</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/PqcCert.html>Hybridn&#xE9; certifik&#xE1;ty v C#</a><li><a href=/1brc.html>One Billion Rows Challenge</a><li><a href=/MigraciaBlogu.html>Migr&#xE1;cia blogu</a><li><a href=/PostKvantovaKryptografia.html>Post-kvantov&#xE1; kryptografia v C#</a><li><a href=/BouncyHsm.html>Ako som robil BouncyHsm</a><li><a href=/BuildAutomation.html>Pre&#x10D;o pou&#x17E;&#xED;va&#x165; build automation</a><li><a href=/KeyValueDB.html>Ako na Key-Value datab&#xE1;zu</a><li><a href=/RankFunctions.html>MS SQL a RANK funkcie</a><li><a href=/MongoDbVsRavenDb.html>MongoDB vs. RavenDB</a><li><a href=/WinHttp.html>Pou&#x17E;itie WinHTTP</a><li><a href=/DevelopingAll.html>&#8230;</a></ul></div></div></div><div class=well><h4>V&#x161;eobecn&#xE9;</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/EzoGenerator.html>Gener&#xE1;tor Ezo textov</a><li><a href=/AlternativnyRecept.html>Propag&#xE1;cia alternat&#xED;vnej medic&#xED;ny</a><li><a href=/VotrelciDavnoveku.html>Votrelci d&#xE1;vnoveku</a><li><a href=/GeneralAll.html>&#8230;</a></ul></div></div></div><div class=well><h4>O mne</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/VyvojarskeOdkazy.html>Moje vyvojarske blogy</a><li><a href=/OMne.html>O mne</a><li><a href=/OMneOdkazy.html>Moja tvorba inde</a><li><a href=/Portfolio.html>Portólio</a></ul></div></div></div></div></div><hr><footer><div class="row no-print"><div class="col-lg-8 col-sm-8"><div class=well><h4>Našli ste chybu, alebo chcete niečo doplniť?</h4><p>Ak ste našli chybu v článu, chcete niečo dopniť, alebo sa vyjadriť k téme, môžete na <a href="https://github.com/harrison314/harrison314.github.io/issues/new?title=Pre%C4%8Do%20pou%C5%BE%C3%ADva%C5%A5%20build%20automation&amp;body=https%3A%2F%2Fharrison314.github.io%2FBuildAutomation.html" target=_blank>Githube otvoriť issue</a>.</div></div></div><div class=row><div class=col-lg-12><p>Copyright &copy; harrison314 2013<span class=on-print> - https://harrison314.github.io/</span></div></div></footer></div><script src=js/jquery.js></script><script src=js/bootstrap.min.js></script>