<!DOCTYPE html><html lang=sk><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=X-Xss-Protection content="1; mode=block"><meta http-equiv=X-Content-Type-Options content=nosniff><meta name=viewport content="width=device-width, initial-scale=1"><link rel=alternate type=application/rss+xml title="RSS Feed" href=/feed.rss><link rel=alternate type=application/atom+xml title="Atom Feed" href=/feed.atom><meta name=author content=harrison314><title>Ako ma zachránil Blazor</title><meta name=description content="Ako ma zachránil Blazor pred svetom JavaScriptu."><link href=css/bootstrap.min.css rel=stylesheet><link href=css/blog-post.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><style>img{max-width:100%}.img-center{display:block;margin-left:auto;margin-right:auto}</style><body><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=index.html>harrison314 blog</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/All.html>Obsah</a><li><a href=/DevelopingAll.html>Programovanie</a><li><a href=/GeneralAll.html>Všeobecné</a><li><a href=/OMne.html>O mne</a></ul></div></div></nav><div class=container><div class=row><div class="col-lg-8 col-md-8"><h1>Ako ma zachránil Blazor</h1><div class=publishDate>November 2019</div><p><strong>…pred svetom JavaScriptu</strong><p>V skratke, <a href=https://dotnet.microsoft.com/apps/aspnet/web-apps/blazor>Blazor</a> je SPA framework postavený nad <em>WebAssembly</em>. Ako jazyk pre&nbsp;písanie aplikačnej logiky používa C# a&nbsp;pre komponenty používa Razor components, poskytuje DI kontajner, Razor a&nbsp;plno ďalších dobrých vlastností. Hlavne je v&nbsp;ňom možné použiť takmer akúkoľvek JavaScriptovú a&nbsp;takmer akúkoľvek .Net Standard knižnicu.<p>Momentálne dokončujem svoj prvý produkčný projekt v&nbsp;Blazore, ide v&nbsp;podstate o&nbsp;pár dynamických formulárov, generovanie <em>PKCS#10</em> žiadosti a&nbsp;<em>PKCS#12</em>. Na&nbsp;riešení cez Blazor bolo super, že&nbsp;mi stačilo napísať okolo sto riadkov JavaScriptu (interop na&nbsp;<em>WebCrypto</em>) a&nbsp;všetku ostatnú logiku aj&nbsp;s testami som mal napísanú za&nbsp;dve hodiny. Keby ju píšem v&nbsp;JavaScripte/TypeScripte trvá to dva mesiace. Ako to viem?<p>Túto cestu som už prešliapal.<h2 id=kratka-historia>Krátka história</h2><p>Na konci roku 2015 som začal pozerať po&nbsp;nejakom SPA frameworku, nasadol som na&nbsp;vlnu hype a&nbsp;začal som robiť v&nbsp;Reacte. No&nbsp;keď som sa ho naučil a&nbsp;spravil si jednoduchú aplikáciu, tak to nadšenie zo&nbsp;mňa vyprchalo.<br> (<a href=#Poznamka1>Poznámka 1</a>)<p>V roku 2016 som sa pustil do&nbsp;hoby projektu <a href=PerDia2012.html>PerDia2012</a>, vďaka <a href="https://www.dotvvm.com/">DotVVM</a> som sa dozvedel o&nbsp;<a href="https://knockoutjs.com/">knockout.js</a>. Páčilo sa mi, že&nbsp;<em>knockout.js</em> má prehľadné šablóny, binding, a&nbsp;v spojení s&nbsp;TypeScriptom som dostal objektový kód. Neskôr po&nbsp;pridaní podpory <em>async/await</em> do&nbsp;TS sa mi počet riadkov kódu zredukoval takmer o&nbsp;tretinu.<p>V roku 2017 prišiel projekt, ktorý&nbsp;nebol len pekné GUI k&nbsp;backendu, bolo v&nbsp;ňom dosť šifrovania, HMAC-ovania a&nbsp;podpisovania. A&nbsp;tu začali problémy. Síce všetky prehliadače podporovali štandard <em>WebCrypto</em> (rozumej všade bolo prístupné rovnaké API) ale&nbsp;podporované algoritmy sa líšili naprieč prehliadačmi a&nbsp;nebolo zaručené, že&nbsp;rovnaký výsledok človek dostane na&nbsp;rovnakom prehliadači ale&nbsp;inej platforme. Takže na&nbsp;každé použitie <em>WebCrypto</em> bolo potrebné nájsť alebo&nbsp;napísať polyfill, čo&nbsp;v praxi znamenalo, že&nbsp;pre každú metódu bolo potrebné nájsť a&nbsp;vyskúšať niekoľko NPM balíčkov, pričom každý mal vstup a&nbsp;výstup v&nbsp;inom formáte a&nbsp;ťahal zo&nbsp;sebou plno závislostí. Problémom bola aj&nbsp;kvalita týchto knižníc (nie je AES ako AES).<p>V roku 2018 prišiel veľmi zaujímavý projekt, ktorý&nbsp;ma podobnú funkcionalitu ako <a href="https://azure.microsoft.com/en-us/services/key-vault/">Azure Key Valut</a> (sprístupňuje funkcionalitu <em>HSM</em> ako REST službu).<br> (<a href=#Poznamka2>Poznámka 2</a>)<p>K tejto službe sa písalo GUI pre&nbsp;bežných používateľov, v&nbsp;ktorom mali byť zobrazené prístupné RSA/EC kľúče, certifikáty a&nbsp;malo poskytovať možnosť generovať žiadosti o&nbsp;certifikát. Na&nbsp;tento projekt bol zvolený aktuálny Agular.<p>Čo môže byť ťažké na&nbsp;načítaní certifikátu a&nbsp;vypísaní jeho atribútov, veď v&nbsp;NPM na&nbsp;to musí byť plno knižníc? <strong>Áno je, ale…</strong> Knižnicu <a href="https://pkijs.org/">pkijs</a> sa ukázala v&nbsp;tomto projekte nepoužiteľná, <a href=https://github.com/digitalbazaar/forge>forge</a> vyzerala nádejne, hoci som musel použiť tri iné knižnice aby&nbsp;som dostal čistatelný výstup. Nádej sa rozplynula, keď&nbsp;som jej nenechal sparsovať certifikát s&nbsp;EC kľúčom. Podobne na&nbsp;tom boli ja všetky ostatné, ktoré som našiel. Tak to dopadlo nakoniec tak, že&nbsp;som si našiel RFC-čko ku&nbsp;X509 certifikátom a&nbsp;napísal som si v&nbsp;TypeScripte vlastný parser.<p>Generovanie žiadosti o&nbsp;certifikát (<em>CSR</em> alebo&nbsp;<em>PKCS#10</em>), pomerne jednoduchá vec, našiel som cez 30 knižníc, no&nbsp;prvých 5 vylúčil podľa dokumentácie (<em>To je naozaj také ťažké spraviť v&nbsp;javascriptovej knižnici aspoň jeden extension point?</em>). Ostaté dokumentáciu nemali, tak som ich po&nbsp;jednej skúšal, študoval ich zdrojáky a&nbsp;tým trávil veľa času. Niekoľko z&nbsp;nich som vylúčil kvôli jednoúčelovosti (dali sa použiť iba s&nbsp;inou konkrétnou knižnicu alebo&nbsp;popisovačom). Ostatné sa ani&nbsp;neunúvali dodržiavať štandardy alebo&nbsp;nefungovali vôbec. Keď&nbsp;som vylúčil aj&nbsp;poslednú knižnicu, ktorá mala komentáre vo vietnamčine, tak som si otvoril príslušné RFC-čko a&nbsp;napísal si vlastný generátor <em>PKCS#10</em> žiadostí.<p>Ďalší javascriptovský projekt v&nbsp;tomto roku sa týkal podpisovania dokumentov do&nbsp;štandardného európskeho formátu priamo v&nbsp;prehliadači. Tam bola situácia s&nbsp;NPM balíčkami dosť podobná, nedodržiavanie štandardov, bugy, spájanie a&nbsp;vyberanie veľa knižníc, ktoré navzájom nepasovali, každá mala vstupy a&nbsp;výstupy v&nbsp;inom formáte (vlastný objekt, Uint8Array, Base64, HEX,…), väčšina kódu bola len lepidlo medzi týmito knižnicami a&nbsp;mal som pocit, že&nbsp;sa neustále snažím natlačiť štvorec do&nbsp;kruhového otvoru.<p>Pokračuje to ďalej skladaním XML-ka, máme cez 30 knižníc serializujúcich alebo&nbsp;pracujúcich z&nbsp;XML-kom, jedna nevie používať atribúty, druhá nevie používať hodnoty, ďalšia nevie pracovať s&nbsp;namespacami… Zanedlho si píšem vlastný builder XML-ka.<p>Takto to pokračuje ďalej s&nbsp;XSLT transformáciami, kódovním, a&nbsp;znovu parsovanie certifikátov (síce len RSA, ale&nbsp;bolo potrebné pracovať z&nbsp;rozšíreniami certifikátu),…<br> (<a href=#Poznamka3>Poznámka 3</a>)<h2 id=zaver>Záver</h2><p>Hovorí sa, že&nbsp;v programovaní by nemal človek znovu vynachádzať koleso, no&nbsp;keď má na&nbsp;výber len štvorcové, neotáčajúce sa alebo&nbsp;deravé kolesá, tak na&nbsp;výber príliš nemá. K&nbsp;tomu človek cíti flustráciu ako z&nbsp;<a href="https://www.youtube.com/watch?v=LXvUhk1ORx0">mrogurtu</a>.<p>Myslím, že&nbsp;Blazor je spása pre&nbsp;.NET programátorov, ktorý&nbsp;v prehliadači chcú robiť niečo viac ako len pekné GUI. Mne na&nbsp;danom projekte ušetril týždne času a&nbsp;ako bonus som získal velmi pohodlný vývoj.<h2 id=poznamky>Poznámky</h2><h4 id=Poznamka1>Poznámka 1</h4><p>Pravdepodobne to bolo tým, že&nbsp;mi React príde až pŕliš prehypovaný a&nbsp;mal som skúsenosti s&nbsp;inými technológiami (virtual dom, z&nbsp;programátorských fór mám pocit, že&nbsp;„<em>Odpoveď na&nbsp;základnú otázku života a&nbsp;vesmíru vôbec</em>“ nie je <em>42</em> ale&nbsp;React, dokonca táto odpoveď padala aj&nbsp;pri otázke ako konvertovať video do&nbsp;iného formátu…). Síce sa v&nbsp;prednáškach dozviete, že&nbsp;je to, to najlepšie čo&nbsp;môže byť a&nbsp;všetko ostatné je mŕtve, ale&nbsp;zas každý rok sa mení <em>best practice</em>, ako s&nbsp;ním pracovať. Tiež sa človek dozvie, že&nbsp;je super funkcionálny, ale&nbsp;pre mňa v&nbsp;porovnaní z&nbsp;Haskellom alebo&nbsp;F# príde ako procedurálny kód. A&nbsp;so spojením s&nbsp;manažmentom stavu je zbytočne ukecaný.<h4 id=Poznamka2>Poznámka 2</h4><p>Išlo o&nbsp;veľmi zaujímavý projekt, pri&nbsp;ktorom som sa naučil ako písať auditovatelný kód, o&nbsp;bezpečnosti založenej na&nbsp;typoch a&nbsp;rozhraniach, ako písať virtuálny driver (pre <em>PKCS#11</em>),…<h4 id=Poznamka3>Poznámka 3</h4><p>Tento projekt mal po&nbsp;dokončení prototypu cez 1900 závislostí, po&nbsp;mesiaci mi NPM v&nbsp;380-tich hlási kritické bezpečnostné chyby. V&nbsp;Blazorom projekte, ktorý&nbsp;využíva obdobné technológie mám 3 závislosti.<h4 id=Poznamka4>Poznámka 4</h4><p>Mená produktov neuvádzam zámerne.</div><div class="col-lg-4 col-md-4 hidden-xs hidden-sm"><div class=well><h4>Vývoj</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/eVolby.html>Elektronické voľby</a><li><a href=/Blazor.html>Ako ma zachránil Blazor</a><li><a href=/NetCoreSecuring.html>Dodatočné zabezpečenie .Net Core</a><li><a href=/SlovakWyamTypography.html>Slovenská typografia pre wyam</a><li><a href=/HostCoreInDll.html>CoreCrl v natívnej DLL knižnici</a><li><a href=/SkEidSign.html>Podpisovanie PDF v .Net Core</a><li><a href=/Ansible.html>Ansible a .Net Core</a><li><a href=/GoLang.html>Golang</a><li><a href=/LevenstainOptimalization.html>Optimalizácia výpočtu Levenstainovej vzdialenosti</a><li><a href=/ZabezpecnieAspMvc.html>Zabezpečenie ASP.NET MVC</a></ul></div></div></div><div class=well><h4>Všeobecné</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/EzoGenerator.html>Generátor Ezo textov</a><li><a href=/AlternativnyRecept.html>Propagácia alternatívnej medicíny</a><li><a href=/VotrelciDavnoveku.html>Votrelci dávnoveku</a></ul></div></div></div><div class=well><h4>O mne</h4><div class=row><div class=col-lg-12><ul class=list-unstyled><li><a href=/OMne.html>O mne</a><li><a href=/OMneOdkazy.html>Moja tvorba inde</a><li><a href=/Portfolio.html>Portólio</a></ul></div></div></div></div></div><hr><footer><div class=row><div class="col-lg-8 col-sm-8"><div class=well><h4>Našli ste chybu, alebo chcete niečo doplniť?</h4><p>Ak ste našli chybu v článu, chcete niečo dopniť, alebo sa vyjadriť k téme, môžete na <a href="https://github.com/harrison314/harrison314.github.io/issues/new?title=Ako%20ma%20zachr%C3%A1nil%20Blazor&amp;body=https%3A%2F%2Fharrison314.github.io%2FBlazor.html" target=_blank>Githube otvoriť issue</a>.</div></div></div><div class=row><div class=col-lg-12><p>Copyright © harrison314 2013</div></div></footer></div><script src=js/jquery.js></script><script src=js/bootstrap.min.js></script>